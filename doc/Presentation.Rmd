---
title: "Exam Presentation"
author: "Group 5"
date: "11th May 2021"
output: ioslides_presentation
---

  
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

```{r, echo = FALSE, message = FALSE}
library("tidyverse")
library("knitr")
library("here") # sets path to top level of the project
```

```{r, message = FALSE}
log_mod_treatment <- read_tsv(file = here("results/log_mod_treatment.tsv.gz"))
```


## Outline
### Introduction
- Presentation of data
- Data wrangling

### Materials and Methods
- Data visualization
- Logistic regression
- Principal Component Analysis
- K-means clustering

### Results and discussion


# Introduction

## Introduction | Introduction
- Byar & Greene prostate cancer data, from Andrews DF and Herzberg AM (1985) 
- Compare four different treatments
- 502 observations of 18 variables
- 27 NA values

## Introduction | Variables in the data set
##### -Non-numeric
patno(Patient Number), stage(two types of prostatic cancer), rx(treatment, placebo or different does of estrogen), status(alive or dead from different causes), pf(Time in bed), hx(History of Cardiovascular Disease, yes or no), ekg(Electrocardiography), sg(Combined Index of Stage and Hist. Grade)

##### -Numeric
dtime(Months of Follow-up), age(Age in years), wt(Weight Index, = wt(kg)-ht(cm)+200), sbp(Systolic Blood Pressure/10), dbp(Diastolic Blood Pressure/10), hg(Serum Hemoglobin (g/100ml)), sz(Size of Primary Tumor (cm^2)), ap(Serum Prostatic Acid Phosphatase), bm(Bone Metastases)


## Data wrangling

#### Raw data -> Clean data
- Exclude dtime, sdate and sg
- Renaming

#### Clean data -> Augment data
- Add five new variables: outcome, treatment_mg, EKG_lvl, performance_lvl, age_group

# Materials and Methods

## Data visualization | Pre-treatment variables - Numeric

```{r, echo = FALSE, out.width="100%"}
include_graphics(here("results/04_plot_preTreatContinuous.png"))
```

## Data visualization | Pre-treatment variables - Categorical

```{r, echo = FALSE, out.width="100%"}
include_graphics(here("results/04_plot_preTreatCategorical.png"))
```

## Data visualization | Pre-treatment variables - Heatmap

```{r, echo = FALSE, out.width="70%", fig.align = "center"}
include_graphics(here("results/04_plot_preTreatHeatmap.png"))
```

## Data visualization | Treatment, outcome and age

```{r, echo = FALSE, out.width="90%", fig.align = "center"}
include_graphics(here("results/04_plot_OutcomeTreatment.png"))
```

## Logistic regression

## Logistic regression | Model outcome as function of treatment

Output:
```{r, echo = TRUE}
log_mod_treatment
```

## Logistic regression for each variable | Treatment 1.0 mg

```{r, echo = FALSE, out.width="100%"}
include_graphics(here("results/05_plot_Manhattan.png"))
```

## Logistic regression | Effects of significant variables for treatment 1.0 mg
  
```{r, echo = FALSE, out.width="90%"}
include_graphics(here("results/05_plot_CIeffects.png"))
```

## Logistic regression | Distribution of significant variables for each outcome
```{r, echo = FALSE, out.width="100%"}
include_graphics(here("results/04_plot_significantVariables.png"))
```

## Principal Component Analysis

## Principal Component Analysis
```{r, echo = FALSE, out.width="90%"}
include_graphics(here("results/06_plot_PCA_PCcoords.png"))
```

## Principal Component Analysis
```{r, echo = FALSE, out.width="90%"}
include_graphics(here("results/06_plot_PCA_rotation.png"))
```

## Principal Component Analysis
```{r, echo = FALSE, out.width="90%"}
include_graphics(here("results/06_plot_PCA_varExpl.png"))
``` 

## K-means clustering

## K-means clustering
```{r, echo = FALSE, out.width="90%"}
include_graphics(here("results/07_plot_kmeans_center.png"))
``` 

## K-means clustering
```{r, echo = FALSE, out.width="90%"}
include_graphics(here("results/07_plot_kmeans_scree.png"))
``` 

## Results and discussion

- Stage 3 and 4 patients differ in tumor size and acid phosphatase levels
- Most effective treatment is 1.0 mg estrogen
- Significant variables are tumor size, CVD, age, and weight index


