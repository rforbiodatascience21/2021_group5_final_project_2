---
title: "Analysis of prostate cancer data"
author: "Group 5: Signe Marcussen, Lucille Augusta Green, Guangya Shen, Huijiao Yang"
date: "11th May 2021"
output: ioslides_presentation
---

  
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

```{r, echo = FALSE, message = FALSE}
library("tidyverse")
library("knitr")
library("here") # sets path to top level of the project
```

```{r, message = FALSE}
log_mod_treatment <- read_tsv(file = here("results/log_mod_treatment.tsv.gz"))
```


## Outline
#### Introduction

#### Materials
- <font size="3">Description of data set</font> 

#### Methods
- <font size="3">Data cleaning and wrangling</font>
- <font size="3">Vizualization</font>
- <font size="3">Modelling</font>

#### Results 
- <font size="3">Data visualization</font>
- <font size="3">Logistic regression</font>
- <font size="3">PCA</font>
- <font size="3">K-means clustering</font>

#### Discussion and conclusion


# Introduction

## Introduction
- Prostate cancer data set from Andrews DF and Herzberg AM (1985) 
- Compare four different treatments
- 502 observations of 18 variables
- 27 NA values


# Materials

## Materials | The data set

- patno(Patient Number)
- stage(two types of prostatic cancerï¼‰
- rx(treatment, placebo or different does of estrogen)
- status(alive or dead from different causes)
- pf(Time in bed)
- hx(History of Cardiovascular Disease, yes or no)
- ekg(Electrocardiography)
- sg(Combined Index of Stage and Hist. Grade)

### Numeric Variables in the data set | Continuous  variables
- wt(Weight Index = wt(kg)-ht(cm)+200): 98.93(69.00 ~ 152.00)
- sbp(Systolic Blood Pressure/10): 14.35(8.00 ~ 30.00)
- dbp(Diastolic Blood Pressure/10): 8.15(4.00 ~ 18.00)
- hg(Serum Hemoglobin (g/100ml)): 13.45(5.90 ~ 21.20)
- sz(Size of Primary Tumor (cm^2)): 14.57(0.00 ~ 69.00)
- ap(Serum Prostatic Acid Phosphatase): 12.18(0.01 ~ 999.88)
- bm(Bone Metastases): 0.16(0.00 ~ 1.00)
- age(Age in years): 71.51(48.00 ~ 89.00)

### Discrete  variables
- dtime(Months of Follow-up)


# Methods

## Methods | Data cleaning and wrangling

#### Raw data -> Clean data
- Exclude dtime, sdate and sg
- Renaming

#### Clean data -> Augment data
- Add five new variables: outcome, treatment_mg, EKG_lvl, performance_lvl, age_group

# Materials and Methods

## Methods | Visualization of pre-treatment variables - Numeric

```{r, echo = FALSE, out.width="100%"}
include_graphics(here("results/04_plot_preTreatContinuous.png"))
```

## Methods | Visualization of pre-treatment variables - Categorical

```{r, echo = FALSE, out.width="100%"}
include_graphics(here("results/04_plot_preTreatCategorical.png"))
```

## Methods | Visualization of pre-treatment variables - Heatmap

```{r, echo = FALSE, out.width="70%", fig.align = "center"}
include_graphics(here("results/04_plot_preTreatHeatmap.png"))
```

## Methods | Modelling

- Logistic regression
- PCA
- K-means clustering


# Results

## Results | Treatment, outcome and age

```{r, echo = FALSE, out.width="90%", fig.align = "center"}
include_graphics(here("results/04_plot_OutcomeTreatment.png"))
```

## Results | Logistic model - Outcome as function of treatment

Output:
```{r, echo = TRUE}
log_mod_treatment
```

## Results | Logistic model for each variable - Treatment = 1.0 mg

```{r, echo = FALSE, out.width="100%"}
include_graphics(here("results/05_plot_Manhattan.png"))
```

## Results | Logistic model for each variable - Treatment = 1.0 mg
  
```{r, echo = FALSE, out.width="90%"}
include_graphics(here("results/05_plot_CIeffects.png"))
```

## Results | Distribution of significant variables for each outcome
```{r, echo = FALSE, out.width="100%"}
include_graphics(here("results/04_plot_significantVariables.png"))
```


## Results | Principal Component Analysis

## Results | Principal Component Analysis
```{r, echo = FALSE, out.width="90%"}
include_graphics(here("results/06_plot_PCA_PCcoords.png"))
```

## Results | Principal Component Analysis
```{r, echo = FALSE, out.width="90%"}
include_graphics(here("results/06_plot_PCA_rotation.png"))
```

## Results | Principal Component Analysis
```{r, echo = FALSE, out.width="90%"}
include_graphics(here("results/06_plot_PCA_varExpl.png"))
``` 

## Results | K-means clustering

## Results | K-means clustering
```{r, echo = FALSE, out.width="100%"}
include_graphics(here("results/07_plot_kmeans_center.png"))
``` 

## Results | K-means clustering
```{r, echo = FALSE, out.width="100%"}
include_graphics(here("results/07_plot_kmeans_scree.png"))
``` 

# Discussion and conclusion

## Discussion and conclusion

- Stage 3 and 4 patients differ in tumor size and acid phosphatase levels
- Most effective treatment is 1.0 mg estrogen
- Significant variables are tumor size, CVD, age, and weight index


