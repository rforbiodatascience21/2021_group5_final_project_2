---
title: "Exam Presentation"
author: "Group 5"
date: "11th May 2021"
output: ioslides_presentation
---

  
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

```{r, echo = FALSE, message = FALSE}
library("tidyverse")
library("knitr")
library("kableExtra")
library("here") # sets path to top level of the project
```

```{r, message = FALSE}
log_mod_treatment <- read_tsv(file = here("results/log_mod_treatment.tsv.gz"))
```


## Outline
### Introduction
- Presentation of data
- Data wrangling

### Materials and Methods
- Data visualization
- Logistic regression
- Principal Component Analysis
- K-means clustering

### Results and discussion


# Introduction

## Introduction | Introduction
- Byar & Greene prostate cancer data, from Andrews DF and Herzberg AM (1985) 
- Compare four different treatments
- 502 observations of 18 variables
- 27 NA values

## Introduction

```{r}
#Non-numeric table 
Variables <- c("patient_ID", 
               "stage", 
               "treatment", 
               "status", 
               "performance", 
               "CVD", 
               "EKG" )

Description <- c("Patient number", 
                 "Stage of prostate cancer", 
                 "Dosage of estrogen treatment in mg", 
                 "Status of the patient, alive or or cause of death", 
                 "Activity level based on time in bed", 
                 "History of Cardiovascular Disease", 
                 "Electrocardiography")

Levels <- c(" ",
            "3, 4",
            "Placebo, 0.2 mg, 1.0 mg, 5.0 mg",
            "alive, dead - prostatic ca, dead - heart or vascular, dead - cerebrovascular, dead - pulmonary embolus, dead - other ca, dead - respiratory disease, dead - other specific non-ca, dead - unspecified non-ca, dead - unknown cause",
            "normal activity, in bed < 50% daytime, in bed > 50% daytime, confined to bed",
            "Yes/No",
            "normal, benign, rhythmic disturb & electrolyte ch, heart block or conduction def, heart strain, old MI, recent MI")

table <- cbind(Variables, 
               Description, 
               Levels)

table %>% 
  kable(caption = "Non-numeric Variables in the data set", 
             format = "html") %>% 
  kable_styling("striped", font_size = 13)

```

## Numeric Variables in the data set | Continuous  variables
- wt(Weight Index = wt(kg)-ht(cm)+200): 98.93(69.00 ~ 152.00)
- sbp(Systolic Blood Pressure/10): 14.35(8.00 ~ 30.00)
- dbp(Diastolic Blood Pressure/10): 8.15(4.00 ~ 18.00)
- hg(Serum Hemoglobin (g/100ml)): 13.45(5.90 ~ 21.20)
- sz(Size of Primary Tumor (cm^2)): 14.57(0.00 ~ 69.00)
- ap(Serum Prostatic Acid Phosphatase): 12.18(0.01 ~ 999.88)
- bm(Bone Metastases): 0.16(0.00 ~ 1.00)
- age(Age in years): 71.51(48.00 ~ 89.00)

### Discrete  variables
- dtime(Months of Follow-up)


## Data wrangling

#### Raw data -> Clean data
- Exclude dtime, sdate and sg
- Renaming

#### Clean data -> Augment data
- Add five new variables: outcome, treatment_mg, EKG_lvl, performance_lvl, age_group

# Materials and Methods

## Data visualization | Pre-treatment variables - Numeric

```{r, echo = FALSE, out.width="100%"}
include_graphics(here("results/04_plot_preTreatContinuous.png"))
```

## Data visualization | Pre-treatment variables - Categorical

```{r, echo = FALSE, out.width="100%"}
include_graphics(here("results/04_plot_preTreatCategorical.png"))
```

## Data visualization | Pre-treatment variables - Heatmap

```{r, echo = FALSE, out.width="70%", fig.align = "center"}
include_graphics(here("results/04_plot_preTreatHeatmap.png"))
```

## Data visualization | Treatment, outcome and age

```{r, echo = FALSE, out.width="90%", fig.align = "center"}
include_graphics(here("results/04_plot_OutcomeTreatment.png"))
```

## Logistic regression | Model outcome as function of treatment

Output:
```{r, echo = TRUE}
log_mod_treatment
```

## Logistic regression for each variable | Treatment 1.0 mg

```{r, echo = FALSE, out.width="100%"}
include_graphics(here("results/05_plot_Manhattan.png"))
```

## Logistic regression | Effects of significant variables for treatment 1.0 mg
  
```{r, echo = FALSE, out.width="90%"}
include_graphics(here("results/05_plot_CIeffects.png"))
```

## Logistic regression | Distribution of significant variables for each outcome
```{r, echo = FALSE, out.width="100%"}
include_graphics(here("results/04_plot_significantVariables.png"))
```

## Principal Component Analysis

## Principal Component Analysis
```{r, echo = FALSE, out.width="90%"}
include_graphics(here("results/06_plot_PCA_PCcoords.png"))
```

## Principal Component Analysis
```{r, echo = FALSE, out.width="90%"}
include_graphics(here("results/06_plot_PCA_rotation.png"))
```

## Principal Component Analysis
```{r, echo = FALSE, out.width="90%"}
include_graphics(here("results/06_plot_PCA_varExpl.png"))
``` 

## K-means clustering

## K-means clustering
```{r, echo = FALSE, out.width="90%"}
include_graphics(here("results/07_plot_kmeans_center.png"))
``` 

## K-means clustering
```{r, echo = FALSE, out.width="90%"}
include_graphics(here("results/07_plot_kmeans_scree.png"))
``` 

## Results and discussion

- Stage 3 and 4 patients differ in tumor size and acid phosphatase levels
- Most effective treatment is 1.0 mg estrogen
- Significant variables are tumor size, CVD, age, and weight index


